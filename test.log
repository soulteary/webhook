=== RUN   TestNeedEchoVersionInfo
--- PASS: TestNeedEchoVersionInfo (0.00s)
=== RUN   TestCheckPrivilegesParamsCorrect
--- PASS: TestCheckPrivilegesParamsCorrect (0.00s)
=== RUN   TestGetNetAddr
--- PASS: TestGetNetAddr (0.00s)
=== RUN   TestDropPrivileges
--- PASS: TestDropPrivileges (0.00s)
=== RUN   TestSetupLogger
--- PASS: TestSetupLogger (0.00s)
=== RUN   TestGetNetAddr_ErrorHandling
--- PASS: TestGetNetAddr_ErrorHandling (0.00s)
=== RUN   TestDropPrivileges_ErrorHandling
--- PASS: TestDropPrivileges_ErrorHandling (0.00s)
=== RUN   TestSetupLogger_ErrorHandling
--- PASS: TestSetupLogger_ErrorHandling (0.00s)
=== RUN   TestWebhook
=== RUN   TestWebhook/github@test/hooks.json.tmpl
=== RUN   TestWebhook/github-multi-sig@test/hooks.json.tmpl
=== RUN   TestWebhook/github-multi-sig-fail@test/hooks.json.tmpl
=== RUN   TestWebhook/bitbucket@test/hooks.json.tmpl
=== RUN   TestWebhook/gitlab@test/hooks.json.tmpl
=== RUN   TestWebhook/xml@test/hooks.json.tmpl
=== RUN   TestWebhook/txt-raw@test/hooks.json.tmpl
=== RUN   TestWebhook/payload-json-array@test/hooks.json.tmpl
=== RUN   TestWebhook/slash-in-hook-id@test/hooks.json.tmpl
=== RUN   TestWebhook/multipart@test/hooks.json.tmpl
=== RUN   TestWebhook/issue-471@test/hooks.json.tmpl
=== RUN   TestWebhook/issue-471-and@test/hooks.json.tmpl
=== RUN   TestWebhook/missing-cmd-arg@test/hooks.json.tmpl
=== RUN   TestWebhook/missing-env-arg@test/hooks.json.tmpl
=== RUN   TestWebhook/empty-payload-signature@test/hooks.json.tmpl
=== RUN   TestWebhook/request-source@test/hooks.json.tmpl
=== RUN   TestWebhook/global_disallowed_method@test/hooks.json.tmpl
=== RUN   TestWebhook/disallowed_method@test/hooks.json.tmpl
=== RUN   TestWebhook/empty_payload@test/hooks.json.tmpl
=== RUN   TestWebhook/empty_payload@test/hooks.json.tmpl#01
=== RUN   TestWebhook/empty_payload@test/hooks.json.tmpl#02
=== RUN   TestWebhook/don't_capture_output_on_success_by_default@test/hooks.json.tmpl
=== RUN   TestWebhook/capture_output_on_success_with_flag_set@test/hooks.json.tmpl
=== RUN   TestWebhook/don't_capture_output_on_error_by_default@test/hooks.json.tmpl
=== RUN   TestWebhook/capture_output_on_error_with_extra_flag_set@test/hooks.json.tmpl
=== RUN   TestWebhook/static_params_should_pass@test/hooks.json.tmpl
=== RUN   TestWebhook/command_with_space_logs_warning@test/hooks.json.tmpl
=== RUN   TestWebhook/unsupported_content_type_error@test/hooks.json.tmpl
=== RUN   TestWebhook/static_params_with_space_in_filename@test/hooks.json.tmpl
=== RUN   TestWebhook/github@test/hooks.yaml.tmpl
=== RUN   TestWebhook/github-multi-sig@test/hooks.yaml.tmpl
=== RUN   TestWebhook/github-multi-sig-fail@test/hooks.yaml.tmpl
=== RUN   TestWebhook/bitbucket@test/hooks.yaml.tmpl
=== RUN   TestWebhook/gitlab@test/hooks.yaml.tmpl
=== RUN   TestWebhook/xml@test/hooks.yaml.tmpl
=== RUN   TestWebhook/txt-raw@test/hooks.yaml.tmpl
=== RUN   TestWebhook/payload-json-array@test/hooks.yaml.tmpl
=== RUN   TestWebhook/slash-in-hook-id@test/hooks.yaml.tmpl
=== RUN   TestWebhook/multipart@test/hooks.yaml.tmpl
=== RUN   TestWebhook/issue-471@test/hooks.yaml.tmpl
=== RUN   TestWebhook/issue-471-and@test/hooks.yaml.tmpl
=== RUN   TestWebhook/missing-cmd-arg@test/hooks.yaml.tmpl
=== RUN   TestWebhook/missing-env-arg@test/hooks.yaml.tmpl
=== RUN   TestWebhook/empty-payload-signature@test/hooks.yaml.tmpl
=== RUN   TestWebhook/request-source@test/hooks.yaml.tmpl
=== RUN   TestWebhook/global_disallowed_method@test/hooks.yaml.tmpl
=== RUN   TestWebhook/disallowed_method@test/hooks.yaml.tmpl
=== RUN   TestWebhook/empty_payload@test/hooks.yaml.tmpl
=== RUN   TestWebhook/empty_payload@test/hooks.yaml.tmpl#01
=== RUN   TestWebhook/empty_payload@test/hooks.yaml.tmpl#02
=== RUN   TestWebhook/don't_capture_output_on_success_by_default@test/hooks.yaml.tmpl
=== RUN   TestWebhook/capture_output_on_success_with_flag_set@test/hooks.yaml.tmpl
=== RUN   TestWebhook/don't_capture_output_on_error_by_default@test/hooks.yaml.tmpl
=== RUN   TestWebhook/capture_output_on_error_with_extra_flag_set@test/hooks.yaml.tmpl
=== RUN   TestWebhook/static_params_should_pass@test/hooks.yaml.tmpl
=== RUN   TestWebhook/command_with_space_logs_warning@test/hooks.yaml.tmpl
=== RUN   TestWebhook/unsupported_content_type_error@test/hooks.yaml.tmpl
=== RUN   TestWebhook/static_params_with_space_in_filename@test/hooks.yaml.tmpl
--- PASS: TestWebhook (23.77s)
    --- PASS: TestWebhook/github@test/hooks.json.tmpl (8.73s)
    --- PASS: TestWebhook/github-multi-sig@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/github-multi-sig-fail@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/bitbucket@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/gitlab@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/xml@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/txt-raw@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/payload-json-array@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/slash-in-hook-id@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/multipart@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/issue-471@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/issue-471-and@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/missing-cmd-arg@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/missing-env-arg@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/empty-payload-signature@test/hooks.json.tmpl (0.23s)
    --- PASS: TestWebhook/request-source@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/global_disallowed_method@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/disallowed_method@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/empty_payload@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/empty_payload@test/hooks.json.tmpl#01 (0.21s)
    --- PASS: TestWebhook/empty_payload@test/hooks.json.tmpl#02 (0.21s)
    --- PASS: TestWebhook/don't_capture_output_on_success_by_default@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/capture_output_on_success_with_flag_set@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/don't_capture_output_on_error_by_default@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/capture_output_on_error_with_extra_flag_set@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/static_params_should_pass@test/hooks.json.tmpl (0.22s)
    --- PASS: TestWebhook/command_with_space_logs_warning@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/unsupported_content_type_error@test/hooks.json.tmpl (0.21s)
    --- PASS: TestWebhook/static_params_with_space_in_filename@test/hooks.json.tmpl (1.60s)
    --- PASS: TestWebhook/github@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/github-multi-sig@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/github-multi-sig-fail@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/bitbucket@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/gitlab@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/xml@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/txt-raw@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/payload-json-array@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/slash-in-hook-id@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/multipart@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/issue-471@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/issue-471-and@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/missing-cmd-arg@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/missing-env-arg@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/empty-payload-signature@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/request-source@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/global_disallowed_method@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/disallowed_method@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/empty_payload@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/empty_payload@test/hooks.yaml.tmpl#01 (0.21s)
    --- PASS: TestWebhook/empty_payload@test/hooks.yaml.tmpl#02 (0.21s)
    --- PASS: TestWebhook/don't_capture_output_on_success_by_default@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/capture_output_on_success_with_flag_set@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/don't_capture_output_on_error_by_default@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/capture_output_on_error_with_extra_flag_set@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/static_params_should_pass@test/hooks.yaml.tmpl (0.22s)
    --- PASS: TestWebhook/command_with_space_logs_warning@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/unsupported_content_type_error@test/hooks.yaml.tmpl (0.21s)
    --- PASS: TestWebhook/static_params_with_space_in_filename@test/hooks.yaml.tmpl (0.88s)
PASS
ok  	github.com/soulteary/webhook	27.113s
=== RUN   TestParseEnvs
--- PASS: TestParseEnvs (0.00s)
=== RUN   TestParseCLI
--- PASS: TestParseCLI (0.00s)
=== RUN   TestParse
--- PASS: TestParse (0.00s)
=== RUN   TestParseCLI_AllFlags
=== RUN   TestParseCLI_AllFlags/set_host
=== RUN   TestParseCLI_AllFlags/set_port
=== RUN   TestParseCLI_AllFlags/set_verbose
=== RUN   TestParseCLI_AllFlags/set_debug
=== RUN   TestParseCLI_AllFlags/set_logfile
=== RUN   TestParseCLI_AllFlags/set_hooks
=== RUN   TestParseCLI_AllFlags/set_header
=== RUN   TestParseCLI_AllFlags/set_version_flag
=== RUN   TestParseCLI_AllFlags/set_validate-config_flag
=== RUN   TestParseCLI_AllFlags/set_rate_limit_flags
=== RUN   TestParseCLI_AllFlags/set_security_flags
=== RUN   TestParseCLI_AllFlags/set_timeout_flags
--- PASS: TestParseCLI_AllFlags (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_host (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_port (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_verbose (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_debug (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_logfile (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_hooks (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_header (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_version_flag (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_validate-config_flag (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_rate_limit_flags (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_security_flags (0.00s)
    --- PASS: TestParseCLI_AllFlags/set_timeout_flags (0.00s)
=== RUN   TestValidationError
--- PASS: TestValidationError (0.00s)
=== RUN   TestValidationResult
--- PASS: TestValidationResult (0.00s)
=== RUN   TestValidate_Port
=== RUN   TestValidate_Port/valid_port
=== RUN   TestValidate_Port/port_too_small
=== RUN   TestValidate_Port/port_too_large
=== RUN   TestValidate_Port/negative_port
--- PASS: TestValidate_Port (0.00s)
    --- PASS: TestValidate_Port/valid_port (0.00s)
    --- PASS: TestValidate_Port/port_too_small (0.00s)
    --- PASS: TestValidate_Port/port_too_large (0.00s)
    --- PASS: TestValidate_Port/negative_port (0.00s)
=== RUN   TestValidate_LogPath
=== RUN   TestValidate_LogPath/empty_log_path
=== RUN   TestValidate_LogPath/valid_log_path
=== RUN   TestValidate_LogPath/non-existent_directory
=== RUN   TestValidate_LogPath/non-writable_directory
--- PASS: TestValidate_LogPath (0.00s)
    --- PASS: TestValidate_LogPath/empty_log_path (0.00s)
    --- PASS: TestValidate_LogPath/valid_log_path (0.00s)
    --- PASS: TestValidate_LogPath/non-existent_directory (0.00s)
    --- PASS: TestValidate_LogPath/non-writable_directory (0.00s)
=== RUN   TestValidate_PidPath
--- PASS: TestValidate_PidPath (0.00s)
=== RUN   TestValidate_I18nDir
=== RUN   TestValidate_I18nDir/empty_i18n_dir
=== RUN   TestValidate_I18nDir/valid_i18n_dir
=== RUN   TestValidate_I18nDir/non-existent_dir
--- PASS: TestValidate_I18nDir (0.00s)
    --- PASS: TestValidate_I18nDir/empty_i18n_dir (0.00s)
    --- PASS: TestValidate_I18nDir/valid_i18n_dir (0.00s)
    --- PASS: TestValidate_I18nDir/non-existent_dir (0.00s)
=== RUN   TestValidate_Timeouts
=== RUN   TestValidate_Timeouts/all_valid_timeouts
=== RUN   TestValidate_Timeouts/negative_read_header_timeout
=== RUN   TestValidate_Timeouts/negative_read_timeout
=== RUN   TestValidate_Timeouts/negative_write_timeout
=== RUN   TestValidate_Timeouts/negative_idle_timeout
=== RUN   TestValidate_Timeouts/read_header_timeout_greater_than_read_timeout
--- PASS: TestValidate_Timeouts (0.00s)
    --- PASS: TestValidate_Timeouts/all_valid_timeouts (0.00s)
    --- PASS: TestValidate_Timeouts/negative_read_header_timeout (0.00s)
    --- PASS: TestValidate_Timeouts/negative_read_timeout (0.00s)
    --- PASS: TestValidate_Timeouts/negative_write_timeout (0.00s)
    --- PASS: TestValidate_Timeouts/negative_idle_timeout (0.00s)
    --- PASS: TestValidate_Timeouts/read_header_timeout_greater_than_read_timeout (0.00s)
=== RUN   TestValidate_RateLimit
=== RUN   TestValidate_RateLimit/rate_limit_disabled
=== RUN   TestValidate_RateLimit/valid_rate_limit
=== RUN   TestValidate_RateLimit/invalid_RPS
=== RUN   TestValidate_RateLimit/negative_RPS
=== RUN   TestValidate_RateLimit/invalid_burst
=== RUN   TestValidate_RateLimit/negative_burst
--- PASS: TestValidate_RateLimit (0.00s)
    --- PASS: TestValidate_RateLimit/rate_limit_disabled (0.00s)
    --- PASS: TestValidate_RateLimit/valid_rate_limit (0.00s)
    --- PASS: TestValidate_RateLimit/invalid_RPS (0.00s)
    --- PASS: TestValidate_RateLimit/negative_RPS (0.00s)
    --- PASS: TestValidate_RateLimit/invalid_burst (0.00s)
    --- PASS: TestValidate_RateLimit/negative_burst (0.00s)
=== RUN   TestValidate_HookExecution
=== RUN   TestValidate_HookExecution/valid_hook_timeout
=== RUN   TestValidate_HookExecution/negative_hook_timeout
=== RUN   TestValidate_HookExecution/invalid_max_concurrent_hooks
    validate_test.go:496: 
        	Error Trace:	/Users/soulteary/Lab/projects/webhook/internal/flags/validate_test.go:496
        	Error:      	Should be true
        	Test:       	TestValidate_HookExecution/invalid_max_concurrent_hooks
=== RUN   TestValidate_HookExecution/negative_max_concurrent_hooks
=== RUN   TestValidate_HookExecution/negative_hook_execution_timeout
--- FAIL: TestValidate_HookExecution (0.00s)
    --- PASS: TestValidate_HookExecution/valid_hook_timeout (0.00s)
    --- PASS: TestValidate_HookExecution/negative_hook_timeout (0.00s)
    --- FAIL: TestValidate_HookExecution/invalid_max_concurrent_hooks (0.00s)
    --- PASS: TestValidate_HookExecution/negative_max_concurrent_hooks (0.00s)
    --- PASS: TestValidate_HookExecution/negative_hook_execution_timeout (0.00s)
=== RUN   TestValidate_Security
=== RUN   TestValidate_Security/valid_security_settings
    validate_test.go:559: 
        	Error Trace:	/Users/soulteary/Lab/projects/webhook/internal/flags/validate_test.go:559
        	Error:      	Should be false
        	Test:       	TestValidate_Security/valid_security_settings
=== RUN   TestValidate_Security/invalid_max_arg_length
=== RUN   TestValidate_Security/invalid_max_total_args_length
=== RUN   TestValidate_Security/invalid_max_args_count
--- FAIL: TestValidate_Security (0.00s)
    --- FAIL: TestValidate_Security/valid_security_settings (0.00s)
    --- PASS: TestValidate_Security/invalid_max_arg_length (0.00s)
    --- PASS: TestValidate_Security/invalid_max_total_args_length (0.00s)
    --- PASS: TestValidate_Security/invalid_max_args_count (0.00s)
=== RUN   TestValidate_SizeLimits
=== RUN   TestValidate_SizeLimits/valid_size_limits
    validate_test.go:620: 
        	Error Trace:	/Users/soulteary/Lab/projects/webhook/internal/flags/validate_test.go:620
        	Error:      	Should be false
        	Test:       	TestValidate_SizeLimits/valid_size_limits
=== RUN   TestValidate_SizeLimits/invalid_max_multipart_mem
=== RUN   TestValidate_SizeLimits/invalid_max_request_body_size
=== RUN   TestValidate_SizeLimits/invalid_max_header_bytes
--- FAIL: TestValidate_SizeLimits (0.00s)
    --- FAIL: TestValidate_SizeLimits/valid_size_limits (0.00s)
    --- PASS: TestValidate_SizeLimits/invalid_max_multipart_mem (0.00s)
    --- PASS: TestValidate_SizeLimits/invalid_max_request_body_size (0.00s)
    --- PASS: TestValidate_SizeLimits/invalid_max_header_bytes (0.00s)
=== RUN   TestValidate_HookFiles
--- PASS: TestValidate_HookFiles (0.00s)
=== RUN   TestValidate_HookContent
--- PASS: TestValidate_HookContent (0.00s)
=== RUN   TestValidateFilePath
--- PASS: TestValidateFilePath (0.00s)
=== RUN   TestValidateDirectory
--- PASS: TestValidateDirectory (0.00s)
=== RUN   TestIsWritable
--- PASS: TestIsWritable (0.00s)
=== RUN   TestIsReadable
--- PASS: TestIsReadable (0.00s)
FAIL
FAIL	github.com/soulteary/webhook/internal/flags	3.954s
=== RUN   TestGetEnvStr
--- PASS: TestGetEnvStr (0.00s)
=== RUN   TestGetEnvBool
--- PASS: TestGetEnvBool (0.00s)
=== RUN   TestGetEnvInt
--- PASS: TestGetEnvInt (0.00s)
=== RUN   TestGetVerifiedLocalCode
=== RUN   TestGetVerifiedLocalCode/Valid_input
=== RUN   TestGetVerifiedLocalCode/Invalid_input
=== RUN   TestGetVerifiedLocalCode/Empty_input
--- PASS: TestGetVerifiedLocalCode (0.00s)
    --- PASS: TestGetVerifiedLocalCode/Valid_input (0.00s)
    --- PASS: TestGetVerifiedLocalCode/Invalid_input (0.00s)
    --- PASS: TestGetVerifiedLocalCode/Empty_input (0.00s)
=== RUN   TestScanDirByExt
--- PASS: TestScanDirByExt (0.00s)
=== RUN   TestRemoveNewlinesAndTabs
--- PASS: TestRemoveNewlinesAndTabs (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/fn	3.481s
=== RUN   TestGetParameter
=== RUN   TestGetParameter/simple_map_key
=== RUN   TestGetParameter/dotted_key_in_map
=== RUN   TestGetParameter/nested_map
=== RUN   TestGetParameter/numeric_key_in_map
=== RUN   TestGetParameter/slice_index
=== RUN   TestGetParameter/direct_slice_index
=== RUN   TestGetParameter/missing_key
=== RUN   TestGetParameter/missing_nested_key
=== RUN   TestGetParameter/missing_parent_key
=== RUN   TestGetParameter/out_of_range_slice_index
--- PASS: TestGetParameter (0.00s)
    --- PASS: TestGetParameter/simple_map_key (0.00s)
    --- PASS: TestGetParameter/dotted_key_in_map (0.00s)
    --- PASS: TestGetParameter/nested_map (0.00s)
    --- PASS: TestGetParameter/numeric_key_in_map (0.00s)
    --- PASS: TestGetParameter/slice_index (0.00s)
    --- PASS: TestGetParameter/direct_slice_index (0.00s)
    --- PASS: TestGetParameter/missing_key (0.00s)
    --- PASS: TestGetParameter/missing_nested_key (0.00s)
    --- PASS: TestGetParameter/missing_parent_key (0.00s)
    --- PASS: TestGetParameter/out_of_range_slice_index (0.00s)
=== RUN   TestCheckPayloadSignature
=== RUN   TestCheckPayloadSignature/case_0
=== RUN   TestCheckPayloadSignature/case_1
=== RUN   TestCheckPayloadSignature/case_2
=== RUN   TestCheckPayloadSignature/case_3
=== RUN   TestCheckPayloadSignature/case_4
=== RUN   TestCheckPayloadSignature/case_5
=== RUN   TestCheckPayloadSignature/case_6
=== RUN   TestCheckPayloadSignature/case_7
=== RUN   TestCheckPayloadSignature/case_8
=== RUN   TestCheckPayloadSignature/case_9
--- PASS: TestCheckPayloadSignature (0.00s)
    --- PASS: TestCheckPayloadSignature/case_0 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_1 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_2 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_3 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_4 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_5 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_6 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_7 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_8 (0.00s)
    --- PASS: TestCheckPayloadSignature/case_9 (0.00s)
=== RUN   TestCheckPayloadSignature256
=== RUN   TestCheckPayloadSignature256/case_0
=== RUN   TestCheckPayloadSignature256/case_1
=== RUN   TestCheckPayloadSignature256/case_2
=== RUN   TestCheckPayloadSignature256/case_3
=== RUN   TestCheckPayloadSignature256/case_4
=== RUN   TestCheckPayloadSignature256/case_5
=== RUN   TestCheckPayloadSignature256/case_6
=== RUN   TestCheckPayloadSignature256/case_7
=== RUN   TestCheckPayloadSignature256/case_8
--- PASS: TestCheckPayloadSignature256 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_0 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_1 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_2 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_3 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_4 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_5 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_6 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_7 (0.00s)
    --- PASS: TestCheckPayloadSignature256/case_8 (0.00s)
=== RUN   TestCheckPayloadSignature512
=== RUN   TestCheckPayloadSignature512/case_0
=== RUN   TestCheckPayloadSignature512/case_1
=== RUN   TestCheckPayloadSignature512/case_2
=== RUN   TestCheckPayloadSignature512/case_3
=== RUN   TestCheckPayloadSignature512/case_4
=== RUN   TestCheckPayloadSignature512/case_5
--- PASS: TestCheckPayloadSignature512 (0.00s)
    --- PASS: TestCheckPayloadSignature512/case_0 (0.00s)
    --- PASS: TestCheckPayloadSignature512/case_1 (0.00s)
    --- PASS: TestCheckPayloadSignature512/case_2 (0.00s)
    --- PASS: TestCheckPayloadSignature512/case_3 (0.00s)
    --- PASS: TestCheckPayloadSignature512/case_4 (0.00s)
    --- PASS: TestCheckPayloadSignature512/case_5 (0.00s)
=== RUN   TestCheckScalrSignature
=== RUN   TestCheckScalrSignature/Valid_signature
=== RUN   TestCheckScalrSignature/Wrong_signature
=== RUN   TestCheckScalrSignature/Missing_Date_header
=== RUN   TestCheckScalrSignature/Missing_X-Signature_header
=== RUN   TestCheckScalrSignature/Missing_signing_key
--- PASS: TestCheckScalrSignature (0.00s)
    --- PASS: TestCheckScalrSignature/Valid_signature (0.00s)
    --- PASS: TestCheckScalrSignature/Wrong_signature (0.00s)
    --- PASS: TestCheckScalrSignature/Missing_Date_header (0.00s)
    --- PASS: TestCheckScalrSignature/Missing_X-Signature_header (0.00s)
    --- PASS: TestCheckScalrSignature/Missing_signing_key (0.00s)
=== RUN   TestCheckMSTeamsSignature
=== RUN   TestCheckMSTeamsSignature/Valid_signature
=== RUN   TestCheckMSTeamsSignature/Wrong_signature
=== RUN   TestCheckMSTeamsSignature/Missing_Authorization_header
=== RUN   TestCheckMSTeamsSignature/Malformed_Authorization_header
=== RUN   TestCheckMSTeamsSignature/Missing_signing_key
=== RUN   TestCheckMSTeamsSignature/Malformed_signing_key
--- PASS: TestCheckMSTeamsSignature (0.00s)
    --- PASS: TestCheckMSTeamsSignature/Valid_signature (0.00s)
    --- PASS: TestCheckMSTeamsSignature/Wrong_signature (0.00s)
    --- PASS: TestCheckMSTeamsSignature/Missing_Authorization_header (0.00s)
    --- PASS: TestCheckMSTeamsSignature/Malformed_Authorization_header (0.00s)
    --- PASS: TestCheckMSTeamsSignature/Missing_signing_key (0.00s)
    --- PASS: TestCheckMSTeamsSignature/Malformed_signing_key (0.00s)
=== RUN   TestCheckIPWhitelist
=== RUN   TestCheckIPWhitelist/case_0
=== RUN   TestCheckIPWhitelist/case_1
=== RUN   TestCheckIPWhitelist/case_2
=== RUN   TestCheckIPWhitelist/case_3
=== RUN   TestCheckIPWhitelist/case_4
=== RUN   TestCheckIPWhitelist/case_5
=== RUN   TestCheckIPWhitelist/case_6
--- PASS: TestCheckIPWhitelist (0.00s)
    --- PASS: TestCheckIPWhitelist/case_0 (0.00s)
    --- PASS: TestCheckIPWhitelist/case_1 (0.00s)
    --- PASS: TestCheckIPWhitelist/case_2 (0.00s)
    --- PASS: TestCheckIPWhitelist/case_3 (0.00s)
    --- PASS: TestCheckIPWhitelist/case_4 (0.00s)
    --- PASS: TestCheckIPWhitelist/case_5 (0.00s)
    --- PASS: TestCheckIPWhitelist/case_6 (0.00s)
=== RUN   TestExtractParameter
--- PASS: TestExtractParameter (0.00s)
=== RUN   TestArgumentGet
--- PASS: TestArgumentGet (0.00s)
=== RUN   TestHookParseJSONParameters
--- PASS: TestHookParseJSONParameters (0.00s)
=== RUN   TestHookExtractCommandArguments
--- PASS: TestHookExtractCommandArguments (0.00s)
=== RUN   TestHookExtractCommandArgumentsForEnv
--- PASS: TestHookExtractCommandArgumentsForEnv (0.00s)
=== RUN   TestHooksLoadFromFile
--- PASS: TestHooksLoadFromFile (0.00s)
=== RUN   TestHooksTemplateLoadFromFile
--- PASS: TestHooksTemplateLoadFromFile (0.00s)
=== RUN   TestHooksMatch
--- PASS: TestHooksMatch (0.00s)
=== RUN   TestMatchRule
--- PASS: TestMatchRule (0.00s)
=== RUN   TestAndRule
--- PASS: TestAndRule (0.00s)
=== RUN   TestOrRule
--- PASS: TestOrRule (0.00s)
=== RUN   TestNotRule
--- PASS: TestNotRule (0.00s)
=== RUN   TestCompare
--- PASS: TestCompare (0.00s)
=== RUN   TestResponseHeaders_String
--- PASS: TestResponseHeaders_String (0.00s)
=== RUN   TestResponseHeaders_Set
--- PASS: TestResponseHeaders_Set (0.00s)
=== RUN   TestHooksFiles_String
--- PASS: TestHooksFiles_String (0.00s)
=== RUN   TestHooksFiles_Set
--- PASS: TestHooksFiles_Set (0.00s)
=== RUN   TestHooks_Append
--- PASS: TestHooks_Append (0.00s)
=== RUN   TestHook_ExtractCommandArgumentsForFile
--- PASS: TestHook_ExtractCommandArgumentsForFile (0.00s)
=== RUN   TestParseJSONPayload
--- PASS: TestParseJSONPayload (0.00s)
=== RUN   TestParseHeaders
--- PASS: TestParseHeaders (0.00s)
=== RUN   TestParseQuery
--- PASS: TestParseQuery (0.00s)
=== RUN   TestParseFormPayload
--- PASS: TestParseFormPayload (0.00s)
=== RUN   TestParseXMLPayload
--- PASS: TestParseXMLPayload (0.00s)
=== RUN   TestParameterNodeError_Error
--- PASS: TestParameterNodeError_Error (0.00s)
=== RUN   TestIsParameterNodeError
--- PASS: TestIsParameterNodeError (0.00s)
=== RUN   TestSignatureError_Error
--- PASS: TestSignatureError_Error (0.00s)
=== RUN   TestIsSignatureError
--- PASS: TestIsSignatureError (0.00s)
=== RUN   TestArgumentError_Error
--- PASS: TestArgumentError_Error (0.00s)
=== RUN   TestSourceError_Error
--- PASS: TestSourceError_Error (0.00s)
=== RUN   TestParseError_Error
--- PASS: TestParseError_Error (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/hook	3.643s
=== RUN   TestLoadLocaleFiles
/var/folders/kt/2wy0pmy562j4dwzscd6wp_v00000gn/T/TestLoadLocaleFiles2072402954/001/invalid.toml invalid locale name
--- PASS: TestLoadLocaleFiles (0.00s)
=== RUN   TestGetWebHookLocaleObject
--- PASS: TestGetWebHookLocaleObject (0.00s)
=== RUN   TestInitLocaleByFiles
--- PASS: TestInitLocaleByFiles (0.00s)
=== RUN   TestSetGlobalLocale
--- PASS: TestSetGlobalLocale (0.00s)
=== RUN   TestGetMessage
--- PASS: TestGetMessage (0.00s)
=== RUN   TestPrintln
webhook version 
webhook version  [test]
--- PASS: TestPrintln (0.00s)
=== RUN   TestSprintf
--- PASS: TestSprintf (0.00s)
=== RUN   TestGetWebHookLocaleObject_InvalidLocale
--- PASS: TestGetWebHookLocaleObject_InvalidLocale (0.00s)
=== RUN   TestGetWebHookLocaleObject_ValidLocale
--- PASS: TestGetWebHookLocaleObject_ValidLocale (0.00s)
=== RUN   TestLoadLocaleFiles_ReadFileError
--- PASS: TestLoadLocaleFiles_ReadFileError (0.00s)
=== RUN   TestLoadLocaleFiles_InvalidLocaleInDir
/var/folders/kt/2wy0pmy562j4dwzscd6wp_v00000gn/T/TestLoadLocaleFiles_InvalidLocaleInDir2897481643/001/invalid-locale.toml invalid locale name
--- PASS: TestLoadLocaleFiles_InvalidLocaleInDir (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/i18n	3.794s
=== RUN   TestMakeBaseURL
=== RUN   TestMakeBaseURL/nil_prefix
=== RUN   TestMakeBaseURL/empty_prefix
=== RUN   TestMakeBaseURL/non-empty_prefix
--- PASS: TestMakeBaseURL (0.00s)
    --- PASS: TestMakeBaseURL/nil_prefix (0.00s)
    --- PASS: TestMakeBaseURL/empty_prefix (0.00s)
    --- PASS: TestMakeBaseURL/non-empty_prefix (0.00s)
=== RUN   TestMakeRoutePattern
=== RUN   TestMakeRoutePattern/nil_prefix_route_pattern
=== RUN   TestMakeRoutePattern/empty_prefix_route_pattern
=== RUN   TestMakeRoutePattern/non-empty_prefix_route_pattern
--- PASS: TestMakeRoutePattern (0.00s)
    --- PASS: TestMakeRoutePattern/nil_prefix_route_pattern (0.00s)
    --- PASS: TestMakeRoutePattern/empty_prefix_route_pattern (0.00s)
    --- PASS: TestMakeRoutePattern/non-empty_prefix_route_pattern (0.00s)
=== RUN   TestMakeHumanPattern
=== RUN   TestMakeHumanPattern/nil_prefix_human_pattern
=== RUN   TestMakeHumanPattern/empty_prefix_human_pattern
=== RUN   TestMakeHumanPattern/non-empty_prefix_human_pattern
--- PASS: TestMakeHumanPattern (0.00s)
    --- PASS: TestMakeHumanPattern/nil_prefix_human_pattern (0.00s)
    --- PASS: TestMakeHumanPattern/empty_prefix_human_pattern (0.00s)
    --- PASS: TestMakeHumanPattern/non-empty_prefix_human_pattern (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/link	3.181s
=== RUN   TestInit
=== RUN   TestInit/verbose_disabled
=== RUN   TestInit/verbose_enabled,_debug_disabled
=== RUN   TestInit/verbose_enabled,_debug_enabled
=== RUN   TestInit/json_format
=== RUN   TestInit/with_log_file
--- PASS: TestInit (0.00s)
    --- PASS: TestInit/verbose_disabled (0.00s)
    --- PASS: TestInit/verbose_enabled,_debug_disabled (0.00s)
    --- PASS: TestInit/verbose_enabled,_debug_enabled (0.00s)
    --- PASS: TestInit/json_format (0.00s)
    --- PASS: TestInit/with_log_file (0.00s)
=== RUN   TestInitWithWriter
=== RUN   TestInitWithWriter/text_format
=== RUN   TestInitWithWriter/json_format
=== RUN   TestInitWithWriter/debug_mode
--- PASS: TestInitWithWriter (0.00s)
    --- PASS: TestInitWithWriter/text_format (0.00s)
    --- PASS: TestInitWithWriter/json_format (0.00s)
    --- PASS: TestInitWithWriter/debug_mode (0.00s)
=== RUN   TestWriter
=== RUN   TestWriter/with_default_writer
=== RUN   TestWriter/without_default_writer
--- PASS: TestWriter (0.00s)
    --- PASS: TestWriter/with_default_writer (0.00s)
    --- PASS: TestWriter/without_default_writer (0.00s)
=== RUN   TestSetDefault
--- PASS: TestSetDefault (0.00s)
=== RUN   TestWith
--- PASS: TestWith (0.00s)
=== RUN   TestWithRequestID
=== RUN   TestWithRequestID/with_request_ID
=== RUN   TestWithRequestID/empty_request_ID
--- PASS: TestWithRequestID (0.00s)
    --- PASS: TestWithRequestID/with_request_ID (0.00s)
    --- PASS: TestWithRequestID/empty_request_ID (0.00s)
=== RUN   TestWithContext
=== RUN   TestWithContext/with_request_ID_in_context
=== RUN   TestWithContext/nil_context
=== RUN   TestWithContext/context_without_request_ID
--- PASS: TestWithContext (0.00s)
    --- PASS: TestWithContext/with_request_ID_in_context (0.00s)
    --- PASS: TestWithContext/nil_context (0.00s)
    --- PASS: TestWithContext/context_without_request_ID (0.00s)
=== RUN   TestContextLogging
--- PASS: TestContextLogging (0.00s)
=== RUN   TestBasicLogging
--- PASS: TestBasicLogging (0.00s)
=== RUN   TestCompatibilityLogging
--- PASS: TestCompatibilityLogging (0.00s)
=== RUN   TestSimpleTextHandler
--- PASS: TestSimpleTextHandler (0.00s)
=== RUN   TestLogLevels
=== RUN   TestLogLevels/debug_log_with_debug_enabled
=== RUN   TestLogLevels/debug_log_with_debug_disabled
--- PASS: TestLogLevels (0.00s)
    --- PASS: TestLogLevels/debug_log_with_debug_enabled (0.00s)
    --- PASS: TestLogLevels/debug_log_with_debug_disabled (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/logger	4.072s
=== RUN   TestRecordHookExecution
--- PASS: TestRecordHookExecution (0.00s)
=== RUN   TestIncrementDecrementConcurrentHooks
--- PASS: TestIncrementDecrementConcurrentHooks (0.00s)
=== RUN   TestRecordHTTPRequest
--- PASS: TestRecordHTTPRequest (0.00s)
=== RUN   TestUpdateSystemMetrics
--- PASS: TestUpdateSystemMetrics (0.00s)
=== RUN   TestStartSystemMetricsCollector
--- PASS: TestStartSystemMetricsCollector (0.20s)
=== RUN   TestConcurrentMetrics
--- PASS: TestConcurrentMetrics (0.00s)
=== RUN   TestMetricsWithDifferentLabels
--- PASS: TestMetricsWithDifferentLabels (0.00s)
=== RUN   TestSystemMemoryMetrics
--- PASS: TestSystemMemoryMetrics (0.00s)
=== RUN   TestGoroutineMetrics
--- PASS: TestGoroutineMetrics (0.01s)
PASS
ok  	github.com/soulteary/webhook/internal/metrics	4.432s
=== RUN   TestDumper
--- PASS: TestDumper (0.00s)
=== RUN   TestResponseDupper_Write
--- PASS: TestResponseDupper_Write (0.00s)
=== RUN   TestResponseDupper_WriteHeader
--- PASS: TestResponseDupper_WriteHeader (0.00s)
=== RUN   TestResponseDupper_Hijack
--- PASS: TestResponseDupper_Hijack (0.00s)
=== RUN   TestNewLogger
--- PASS: TestNewLogger (0.00s)
=== RUN   TestLogger_NewLogEntry
--- PASS: TestLogger_NewLogEntry (0.00s)
=== RUN   TestLogEntry_Write
--- PASS: TestLogEntry_Write (0.00s)
=== RUN   TestLogEntry_Panic
--- PASS: TestLogEntry_Panic (0.00s)
=== RUN   TestNewRateLimiter
=== RUN   TestNewRateLimiter/disabled
=== RUN   TestNewRateLimiter/enabled
--- PASS: TestNewRateLimiter (0.00s)
    --- PASS: TestNewRateLimiter/disabled (0.00s)
    --- PASS: TestNewRateLimiter/enabled (0.00s)
=== RUN   TestRateLimiter_Middleware
--- PASS: TestRateLimiter_Middleware (0.00s)
=== RUN   TestRateLimiter_Middleware_Disabled
--- PASS: TestRateLimiter_Middleware_Disabled (0.00s)
=== RUN   TestRateLimiter_HookMiddleware
--- PASS: TestRateLimiter_HookMiddleware (0.00s)
=== RUN   TestRateLimiter_HookMiddleware_Disabled
--- PASS: TestRateLimiter_HookMiddleware_Disabled (0.00s)
=== RUN   TestNewRateLimitMiddleware
=== RUN   TestNewRateLimitMiddleware/disabled
=== RUN   TestNewRateLimitMiddleware/enabled
--- PASS: TestNewRateLimitMiddleware (0.00s)
    --- PASS: TestNewRateLimitMiddleware/disabled (0.00s)
    --- PASS: TestNewRateLimitMiddleware/enabled (0.00s)
=== RUN   TestExtractIP
=== RUN   TestExtractIP/X-Forwarded-For
=== RUN   TestExtractIP/X-Real-IP
=== RUN   TestExtractIP/RemoteAddr
--- PASS: TestExtractIP (0.00s)
    --- PASS: TestExtractIP/X-Forwarded-For (0.00s)
    --- PASS: TestExtractIP/X-Real-IP (0.00s)
    --- PASS: TestExtractIP/RemoteAddr (0.00s)
=== RUN   TestParseForwardedIP
=== RUN   TestParseForwardedIP/single_IP
=== RUN   TestParseForwardedIP/multiple_IPs
=== RUN   TestParseForwardedIP/with_spaces
=== RUN   TestParseForwardedIP/invalid_IP
=== RUN   TestParseForwardedIP/empty
--- PASS: TestParseForwardedIP (0.00s)
    --- PASS: TestParseForwardedIP/single_IP (0.00s)
    --- PASS: TestParseForwardedIP/multiple_IPs (0.00s)
    --- PASS: TestParseForwardedIP/with_spaces (0.00s)
    --- PASS: TestParseForwardedIP/invalid_IP (0.00s)
    --- PASS: TestParseForwardedIP/empty (0.00s)
=== RUN   TestExtractHookID
=== RUN   TestExtractHookID/simple_path
=== RUN   TestExtractHookID/nested_path
=== RUN   TestExtractHookID/root_path
=== RUN   TestExtractHookID/empty_path
--- PASS: TestExtractHookID (0.00s)
    --- PASS: TestExtractHookID/simple_path (0.00s)
    --- PASS: TestExtractHookID/nested_path (0.00s)
    --- PASS: TestExtractHookID/root_path (0.00s)
    --- PASS: TestExtractHookID/empty_path (0.00s)
=== RUN   TestRateLimiter_Cleanup
--- PASS: TestRateLimiter_Cleanup (0.10s)
=== RUN   TestRateLimiter_ConcurrentAccess
--- PASS: TestRateLimiter_ConcurrentAccess (0.00s)
=== RUN   TestRequestID
--- PASS: TestRequestID (0.00s)
=== RUN   TestRequestID_WithXRequestIDHeader
--- PASS: TestRequestID_WithXRequestIDHeader (0.00s)
=== RUN   TestRequestID_WithLimit
--- PASS: TestRequestID_WithLimit (0.00s)
=== RUN   TestGetReqID
--- PASS: TestGetReqID (0.00s)
=== RUN   TestUseXRequestIDHeaderOption
--- PASS: TestUseXRequestIDHeaderOption (0.00s)
=== RUN   TestXRequestIDLimitOption
--- PASS: TestXRequestIDLimitOption (0.00s)
=== RUN   TestRequestIDOptions_UseRequestID
--- PASS: TestRequestIDOptions_UseRequestID (0.00s)
=== RUN   TestNewRequestIDOptions
--- PASS: TestNewRequestIDOptions (0.00s)
=== RUN   TestSanitizeString
=== RUN   TestSanitizeString/普通字符串
=== RUN   TestSanitizeString/包含password的字符串
=== RUN   TestSanitizeString/包含token的字符串
=== RUN   TestSanitizeString/键值对格式
--- PASS: TestSanitizeString (0.00s)
    --- PASS: TestSanitizeString/普通字符串 (0.00s)
    --- PASS: TestSanitizeString/包含password的字符串 (0.00s)
    --- PASS: TestSanitizeString/包含token的字符串 (0.00s)
    --- PASS: TestSanitizeString/键值对格式 (0.00s)
=== RUN   TestSanitizeHeader
=== RUN   TestSanitizeHeader/普通头
=== RUN   TestSanitizeHeader/Authorization头
=== RUN   TestSanitizeHeader/API-Key头
=== RUN   TestSanitizeHeader/Password头
--- PASS: TestSanitizeHeader (0.00s)
    --- PASS: TestSanitizeHeader/普通头 (0.00s)
    --- PASS: TestSanitizeHeader/Authorization头 (0.00s)
    --- PASS: TestSanitizeHeader/API-Key头 (0.00s)
    --- PASS: TestSanitizeHeader/Password头 (0.00s)
=== RUN   TestSanitizeJSON
=== RUN   TestSanitizeJSON/普通JSON
=== RUN   TestSanitizeJSON/包含password字段
=== RUN   TestSanitizeJSON/包含token字段
=== RUN   TestSanitizeJSON/嵌套JSON
--- PASS: TestSanitizeJSON (0.00s)
    --- PASS: TestSanitizeJSON/普通JSON (0.00s)
    --- PASS: TestSanitizeJSON/包含password字段 (0.00s)
    --- PASS: TestSanitizeJSON/包含token字段 (0.00s)
    --- PASS: TestSanitizeJSON/嵌套JSON (0.00s)
=== RUN   TestSanitizeQueryString
=== RUN   TestSanitizeQueryString/普通查询字符串
=== RUN   TestSanitizeQueryString/包含password参数
=== RUN   TestSanitizeQueryString/包含token参数
--- PASS: TestSanitizeQueryString (0.00s)
    --- PASS: TestSanitizeQueryString/普通查询字符串 (0.00s)
    --- PASS: TestSanitizeQueryString/包含password参数 (0.00s)
    --- PASS: TestSanitizeQueryString/包含token参数 (0.00s)
=== RUN   TestSanitizeError
=== RUN   TestSanitizeError/普通错误消息
=== RUN   TestSanitizeError/包含password的错误
=== RUN   TestSanitizeError/包含token的错误
=== RUN   TestSanitizeError/包含Bearer_token的错误
--- PASS: TestSanitizeError (0.00s)
    --- PASS: TestSanitizeError/普通错误消息 (0.00s)
    --- PASS: TestSanitizeError/包含password的错误 (0.00s)
    --- PASS: TestSanitizeError/包含token的错误 (0.00s)
    --- PASS: TestSanitizeError/包含Bearer_token的错误 (0.00s)
=== RUN   TestSanitizeRequestBody
=== RUN   TestSanitizeRequestBody/不包含请求体
=== RUN   TestSanitizeRequestBody/JSON请求体
=== RUN   TestSanitizeRequestBody/表单请求体
--- PASS: TestSanitizeRequestBody (0.00s)
    --- PASS: TestSanitizeRequestBody/不包含请求体 (0.00s)
    --- PASS: TestSanitizeRequestBody/JSON请求体 (0.00s)
    --- PASS: TestSanitizeRequestBody/表单请求体 (0.00s)
=== RUN   TestSanitizeRequestLine
=== RUN   TestSanitizeRequestLine/请求行无查询参数
=== RUN   TestSanitizeRequestLine/请求行包含查询参数
=== RUN   TestSanitizeRequestLine/请求行包含敏感查询参数
=== RUN   TestSanitizeRequestLine/请求行包含token参数
=== RUN   TestSanitizeRequestLine/请求行包含多个查询参数
--- PASS: TestSanitizeRequestLine (0.00s)
    --- PASS: TestSanitizeRequestLine/请求行无查询参数 (0.00s)
    --- PASS: TestSanitizeRequestLine/请求行包含查询参数 (0.00s)
    --- PASS: TestSanitizeRequestLine/请求行包含敏感查询参数 (0.00s)
    --- PASS: TestSanitizeRequestLine/请求行包含token参数 (0.00s)
    --- PASS: TestSanitizeRequestLine/请求行包含多个查询参数 (0.00s)
=== RUN   TestSanitizeDumpRequest
=== RUN   TestSanitizeDumpRequest/空dump
=== RUN   TestSanitizeDumpRequest/不包含请求体
=== RUN   TestSanitizeDumpRequest/包含敏感头的请求
=== RUN   TestSanitizeDumpRequest/包含JSON请求体
=== RUN   TestSanitizeDumpRequest/包含表单请求体
=== RUN   TestSanitizeDumpRequest/包含敏感查询参数的请求行
=== RUN   TestSanitizeDumpRequest/包含多种HTTP方法的请求行
=== RUN   TestSanitizeDumpRequest/PUT方法
=== RUN   TestSanitizeDumpRequest/DELETE方法
=== RUN   TestSanitizeDumpRequest/PATCH方法
=== RUN   TestSanitizeDumpRequest/HEAD方法
=== RUN   TestSanitizeDumpRequest/OPTIONS方法
--- PASS: TestSanitizeDumpRequest (0.00s)
    --- PASS: TestSanitizeDumpRequest/空dump (0.00s)
    --- PASS: TestSanitizeDumpRequest/不包含请求体 (0.00s)
    --- PASS: TestSanitizeDumpRequest/包含敏感头的请求 (0.00s)
    --- PASS: TestSanitizeDumpRequest/包含JSON请求体 (0.00s)
    --- PASS: TestSanitizeDumpRequest/包含表单请求体 (0.00s)
    --- PASS: TestSanitizeDumpRequest/包含敏感查询参数的请求行 (0.00s)
    --- PASS: TestSanitizeDumpRequest/包含多种HTTP方法的请求行 (0.00s)
    --- PASS: TestSanitizeDumpRequest/PUT方法 (0.00s)
    --- PASS: TestSanitizeDumpRequest/DELETE方法 (0.00s)
    --- PASS: TestSanitizeDumpRequest/PATCH方法 (0.00s)
    --- PASS: TestSanitizeDumpRequest/HEAD方法 (0.00s)
    --- PASS: TestSanitizeDumpRequest/OPTIONS方法 (0.00s)
=== RUN   TestSanitizeDumpRequest_ComplexCase
--- PASS: TestSanitizeDumpRequest_ComplexCase (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/middleware	1.019s
=== RUN   TestWatchForFileChange
    monitor_test.go:88: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange (1.91s)
=== RUN   TestWatchForFileChange_Remove
    monitor_test.go:151: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_Remove (1.31s)
=== RUN   TestWatchForFileChange_Error
    monitor_test.go:181: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_Error (1.10s)
=== RUN   TestWatchForFileChange_Rename_Overwritten
    monitor_test.go:248: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_Rename_Overwritten (1.71s)
=== RUN   TestWatchForFileChange_Rename_Removed
    monitor_test.go:314: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_Rename_Removed (1.51s)
=== RUN   TestWatchForFileChange_Remove_FileStillExists
    monitor_test.go:374: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_Remove_FileStillExists (1.20s)
=== RUN   TestWatchForFileChange_RemoveError
    monitor_test.go:440: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_RemoveError (1.51s)
=== RUN   TestWatchForFileChange_RenameAddError
    monitor_test.go:506: WatchForFileChange goroutine did not exit in time
--- PASS: TestWatchForFileChange_RenameAddError (1.71s)
=== RUN   TestRetryReloadHooks
--- PASS: TestRetryReloadHooks (0.20s)
=== RUN   TestApplyWatcher
--- PASS: TestApplyWatcher (0.00s)
=== RUN   TestApplyWatcher_ErrorAddingFile
--- PASS: TestApplyWatcher_ErrorAddingFile (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/monitor	12.962s
=== RUN   TestNewAndRemove
--- PASS: TestNewAndRemove (0.00s)
=== RUN   TestRemoveInvalidPath
--- PASS: TestRemoveInvalidPath (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/pidfile	0.837s
=== RUN   TestSetupSignals
--- PASS: TestSetupSignals (0.60s)
=== RUN   TestSetupSignalsWithHandler
--- PASS: TestSetupSignalsWithHandler (0.50s)
=== RUN   TestSignalHandler
--- PASS: TestSignalHandler (0.25s)
=== RUN   TestDropPrivileges
--- PASS: TestDropPrivileges (0.00s)
=== RUN   TestDropPrivileges_ErrorPaths
--- PASS: TestDropPrivileges_ErrorPaths (0.00s)
=== RUN   TestNewSignalHandler_WithNil
--- PASS: TestNewSignalHandler_WithNil (0.00s)
=== RUN   TestSetupSignalsWithHandler_WithNilSignals
--- PASS: TestSetupSignalsWithHandler_WithNilSignals (0.30s)
=== RUN   TestSetupSignalsWithHandler_WithNilExitFunc
--- PASS: TestSetupSignalsWithHandler_WithNilExitFunc (0.30s)
=== RUN   TestWatchForSignals_WithPidFile_RemoveError
--- PASS: TestWatchForSignals_WithPidFile_RemoveError (0.15s)
=== RUN   TestWatchForSignals_WithPidFile_Success
--- PASS: TestWatchForSignals_WithPidFile_Success (0.15s)
=== RUN   TestWatchForSignals_WithNilPidFile
--- PASS: TestWatchForSignals_WithNilPidFile (0.15s)
PASS
ok  	github.com/soulteary/webhook/internal/platform	3.209s
=== RUN   TestRemoveHooks
--- PASS: TestRemoveHooks (0.00s)
=== RUN   TestLenLoadedHooks
--- PASS: TestLenLoadedHooks (0.00s)
=== RUN   TestMatchLoadedHook
=== RUN   TestMatchLoadedHook/hook1
=== RUN   TestMatchLoadedHook/hook2
=== RUN   TestMatchLoadedHook/nonexistent
--- PASS: TestMatchLoadedHook (0.00s)
    --- PASS: TestMatchLoadedHook/hook1 (0.00s)
    --- PASS: TestMatchLoadedHook/hook2 (0.00s)
    --- PASS: TestMatchLoadedHook/nonexistent (0.00s)
=== RUN   TestReloadHooks
--- PASS: TestReloadHooks (0.00s)
=== RUN   TestReloadHooks_WithTemplate
--- PASS: TestReloadHooks_WithTemplate (0.00s)
=== RUN   TestReloadHooks_DuplicateID
--- PASS: TestReloadHooks_DuplicateID (0.00s)
=== RUN   TestReloadAllHooksAsTemplate
--- PASS: TestReloadAllHooksAsTemplate (0.00s)
=== RUN   TestReloadAllHooksNotAsTemplate
--- PASS: TestReloadAllHooksNotAsTemplate (0.00s)
=== RUN   TestParseAndLoadHooks
--- PASS: TestParseAndLoadHooks (0.00s)
=== RUN   TestParseAndLoadHooks_InvalidFile
--- PASS: TestParseAndLoadHooks_InvalidFile (0.00s)
=== RUN   TestRemoveHooks_WithVerbose
--- PASS: TestRemoveHooks_WithVerbose (0.00s)
=== RUN   TestRemoveHooks_WithNoPanic
--- PASS: TestRemoveHooks_WithNoPanic (0.00s)
=== RUN   TestRemoveHooks_EmptyHooksFiles
--- PASS: TestRemoveHooks_EmptyHooksFiles (0.00s)
=== RUN   TestReloadHooks_ErrorLoading
--- PASS: TestReloadHooks_ErrorLoading (0.00s)
=== RUN   TestReloadHooks_WithSeenHooksIds
--- PASS: TestReloadHooks_WithSeenHooksIds (0.00s)
=== RUN   TestRLockHooksFiles
--- PASS: TestRLockHooksFiles (0.00s)
=== RUN   TestLockHooksFiles
--- PASS: TestLockHooksFiles (0.00s)
=== RUN   TestMatchLoadedHook_IndexRebuild
panic: test timed out after 1m0s
	running tests:
		TestMatchLoadedHook_IndexRebuild (1m0s)

goroutine 49 [running]:
testing.(*M).startAlarm.func1()
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:2682 +0x2b0
created by time.goFunc
	/Users/soulteary/.gvm/gos/go1.25.4/src/time/sleep.go:215 +0x38

goroutine 1 [chan receive]:
testing.(*T).Run(0x140000036c0, {0x1007bd6ea?, 0x1400013bb38?}, 0x100909c60)
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:2005 +0x378
testing.runTests.func1(0x140000036c0)
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:2477 +0x38
testing.tRunner(0x140000036c0, 0x1400013bc68)
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:1934 +0xc8
testing.runTests(0x1400000e4e0, {0x100bca200, 0x13, 0x13}, {0x140001066c0?, 0x7?, 0x100bd1180?})
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:2475 +0x3b8
testing.(*M).Run(0x14000162820)
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:2337 +0x530
main.main()
	_testmain.go:83 +0x80

goroutine 41 [sync.Mutex.Lock]:
internal/sync.runtime_SemacquireMutex(0x14000076df8?, 0x14?, 0x148?)
	/Users/soulteary/.gvm/gos/go1.25.4/src/runtime/sema.go:95 +0x28
internal/sync.(*Mutex).lockSlow(0x100bf8b20)
	/Users/soulteary/.gvm/gos/go1.25.4/src/internal/sync/mutex.go:149 +0x170
internal/sync.(*Mutex).Lock(...)
	/Users/soulteary/.gvm/gos/go1.25.4/src/internal/sync/mutex.go:70
sync.(*Mutex).Lock(...)
	/Users/soulteary/.gvm/gos/go1.25.4/src/sync/mutex.go:46
sync.(*RWMutex).Lock(0x100bf8b20)
	/Users/soulteary/.gvm/gos/go1.25.4/src/sync/rwmutex.go:150 +0x6c
github.com/soulteary/webhook/internal/rules.BuildIndex()
	/Users/soulteary/Lab/projects/webhook/internal/rules/rules.go:77 +0x30
github.com/soulteary/webhook/internal/rules_test.TestMatchLoadedHook_IndexRebuild(0x140001aa000)
	/Users/soulteary/Lab/projects/webhook/internal/rules/rules_test.go:379 +0x114
testing.tRunner(0x140001aa000, 0x100909c60)
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:1934 +0xc8
created by testing.(*T).Run in goroutine 1
	/Users/soulteary/.gvm/gos/go1.25.4/src/testing/testing.go:1997 +0x364
FAIL	github.com/soulteary/webhook/internal/rules	60.947s
=== RUN   TestNewCommandValidator
--- PASS: TestNewCommandValidator (0.00s)
=== RUN   TestValidateCommandPath
=== RUN   TestValidateCommandPath/no_whitelist
=== RUN   TestValidateCommandPath/with_whitelist_-_directory
=== RUN   TestValidateCommandPath/with_whitelist_-_exact_file
=== RUN   TestValidateCommandPath/with_whitelist_-_not_allowed
=== RUN   TestValidateCommandPath/relative_path
--- PASS: TestValidateCommandPath (0.00s)
    --- PASS: TestValidateCommandPath/no_whitelist (0.00s)
    --- PASS: TestValidateCommandPath/with_whitelist_-_directory (0.00s)
    --- PASS: TestValidateCommandPath/with_whitelist_-_exact_file (0.00s)
    --- PASS: TestValidateCommandPath/with_whitelist_-_not_allowed (0.00s)
    --- PASS: TestValidateCommandPath/relative_path (0.00s)
=== RUN   TestValidateArgs
=== RUN   TestValidateArgs/valid_args
=== RUN   TestValidateArgs/too_many_args
=== RUN   TestValidateArgs/arg_too_long
=== RUN   TestValidateArgs/total_args_too_long
=== RUN   TestValidateArgs/strict_mode_-_dangerous_characters
=== RUN   TestValidateArgs/strict_mode_-_safe_args
--- PASS: TestValidateArgs (0.00s)
    --- PASS: TestValidateArgs/valid_args (0.00s)
    --- PASS: TestValidateArgs/too_many_args (0.00s)
    --- PASS: TestValidateArgs/arg_too_long (0.00s)
    --- PASS: TestValidateArgs/total_args_too_long (0.00s)
    --- PASS: TestValidateArgs/strict_mode_-_dangerous_characters (0.00s)
    --- PASS: TestValidateArgs/strict_mode_-_safe_args (0.00s)
=== RUN   TestSanitizeForLog
=== RUN   TestSanitizeForLog/normal_command_and_args
=== RUN   TestSanitizeForLog/long_command_path
=== RUN   TestSanitizeForLog/sensitive_information_in_args
=== RUN   TestSanitizeForLog/long_arg
--- PASS: TestSanitizeForLog (0.00s)
    --- PASS: TestSanitizeForLog/normal_command_and_args (0.00s)
    --- PASS: TestSanitizeForLog/long_command_path (0.00s)
    --- PASS: TestSanitizeForLog/sensitive_information_in_args (0.00s)
    --- PASS: TestSanitizeForLog/long_arg (0.00s)
=== RUN   TestLogCommandExecution
--- PASS: TestLogCommandExecution (0.00s)
=== RUN   TestValidateCommand
=== RUN   TestValidateCommand/valid_command
=== RUN   TestValidateCommand/invalid_path
=== RUN   TestValidateCommand/invalid_args
--- PASS: TestValidateCommand (0.00s)
    --- PASS: TestValidateCommand/valid_command (0.00s)
    --- PASS: TestValidateCommand/invalid_path (0.00s)
    --- PASS: TestValidateCommand/invalid_args (0.00s)
=== RUN   TestCommandValidationError
--- PASS: TestCommandValidationError (0.00s)
=== RUN   TestIsDirectory
=== RUN   TestIsDirectory/existing_directory
=== RUN   TestIsDirectory/existing_file
=== RUN   TestIsDirectory/non-existent_path_with_separator
=== RUN   TestIsDirectory/non-existent_path_without_separator
--- PASS: TestIsDirectory (0.00s)
    --- PASS: TestIsDirectory/existing_directory (0.00s)
    --- PASS: TestIsDirectory/existing_file (0.00s)
    --- PASS: TestIsDirectory/non-existent_path_with_separator (0.00s)
    --- PASS: TestIsDirectory/non-existent_path_without_separator (0.00s)
=== RUN   TestSanitizeArg
=== RUN   TestSanitizeArg/normal_arg
=== RUN   TestSanitizeArg/long_arg
=== RUN   TestSanitizeArg/sensitive_arg
--- PASS: TestSanitizeArg (0.00s)
    --- PASS: TestSanitizeArg/normal_arg (0.00s)
    --- PASS: TestSanitizeArg/long_arg (0.00s)
    --- PASS: TestSanitizeArg/sensitive_arg (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/security	2.837s
=== RUN   TestNewHTTPError
--- PASS: TestNewHTTPError (0.00s)
=== RUN   TestHTTPError_WithRequestID
--- PASS: TestHTTPError_WithRequestID (0.00s)
=== RUN   TestHTTPError_WithHookID
--- PASS: TestHTTPError_WithHookID (0.00s)
=== RUN   TestHTTPError_Error
=== RUN   TestHTTPError_Error/with_error
=== RUN   TestHTTPError_Error/without_error
--- PASS: TestHTTPError_Error (0.00s)
    --- PASS: TestHTTPError_Error/with_error (0.00s)
    --- PASS: TestHTTPError_Error/without_error (0.00s)
=== RUN   TestClassifyError
=== RUN   TestClassifyError/nil_error
=== RUN   TestClassifyError/HTTPError
=== RUN   TestClassifyError/context_deadline_exceeded
=== RUN   TestClassifyError/context_canceled
=== RUN   TestClassifyError/parameter_node_error
=== RUN   TestClassifyError/signature_error
=== RUN   TestClassifyError/command_validation_error
=== RUN   TestClassifyError/permission_denied
=== RUN   TestClassifyError/not_found
=== RUN   TestClassifyError/invalid
=== RUN   TestClassifyError/generic_error
--- PASS: TestClassifyError (0.00s)
    --- PASS: TestClassifyError/nil_error (0.00s)
    --- PASS: TestClassifyError/HTTPError (0.00s)
    --- PASS: TestClassifyError/context_deadline_exceeded (0.00s)
    --- PASS: TestClassifyError/context_canceled (0.00s)
    --- PASS: TestClassifyError/parameter_node_error (0.00s)
    --- PASS: TestClassifyError/signature_error (0.00s)
    --- PASS: TestClassifyError/command_validation_error (0.00s)
    --- PASS: TestClassifyError/permission_denied (0.00s)
    --- PASS: TestClassifyError/not_found (0.00s)
    --- PASS: TestClassifyError/invalid (0.00s)
    --- PASS: TestClassifyError/generic_error (0.00s)
=== RUN   TestHandleError
=== RUN   TestHandleError/nil_error
=== RUN   TestHandleError/client_error
=== RUN   TestHandleError/server_error
--- PASS: TestHandleError (0.00s)
    --- PASS: TestHandleError/nil_error (0.00s)
    --- PASS: TestHandleError/client_error (0.00s)
    --- PASS: TestHandleError/server_error (0.00s)
=== RUN   TestHandleErrorPlain
--- PASS: TestHandleErrorPlain (0.00s)
=== RUN   TestHandleErrorWithCustomMessage
--- PASS: TestHandleErrorWithCustomMessage (0.00s)
=== RUN   TestIsClientError
=== RUN   TestIsClientError/client_error
=== RUN   TestIsClientError/server_error
=== RUN   TestIsClientError/timeout_error
=== RUN   TestIsClientError/regular_error
--- PASS: TestIsClientError (0.00s)
    --- PASS: TestIsClientError/client_error (0.00s)
    --- PASS: TestIsClientError/server_error (0.00s)
    --- PASS: TestIsClientError/timeout_error (0.00s)
    --- PASS: TestIsClientError/regular_error (0.00s)
=== RUN   TestIsServerError
=== RUN   TestIsServerError/server_error
=== RUN   TestIsServerError/client_error
=== RUN   TestIsServerError/timeout_error
=== RUN   TestIsServerError/regular_error
--- PASS: TestIsServerError (0.00s)
    --- PASS: TestIsServerError/server_error (0.00s)
    --- PASS: TestIsServerError/client_error (0.00s)
    --- PASS: TestIsServerError/timeout_error (0.00s)
    --- PASS: TestIsServerError/regular_error (0.00s)
=== RUN   TestIsTimeoutError
=== RUN   TestIsTimeoutError/timeout_error
=== RUN   TestIsTimeoutError/client_error
=== RUN   TestIsTimeoutError/server_error
=== RUN   TestIsTimeoutError/regular_error
--- PASS: TestIsTimeoutError (0.00s)
    --- PASS: TestIsTimeoutError/timeout_error (0.00s)
    --- PASS: TestIsTimeoutError/client_error (0.00s)
    --- PASS: TestIsTimeoutError/server_error (0.00s)
    --- PASS: TestIsTimeoutError/regular_error (0.00s)
=== RUN   TestErrorResponse
--- PASS: TestErrorResponse (0.00s)
=== RUN   TestNewHookExecutor_DefaultValues
=== RUN   TestNewHookExecutor_DefaultValues/valid_values
=== RUN   TestNewHookExecutor_DefaultValues/zero_max_concurrent_uses_default
=== RUN   TestNewHookExecutor_DefaultValues/negative_max_concurrent_uses_default
=== RUN   TestNewHookExecutor_DefaultValues/zero_timeout_uses_default
=== RUN   TestNewHookExecutor_DefaultValues/negative_timeout_uses_default
=== RUN   TestNewHookExecutor_DefaultValues/both_zero_use_defaults
--- PASS: TestNewHookExecutor_DefaultValues (0.00s)
    --- PASS: TestNewHookExecutor_DefaultValues/valid_values (0.00s)
    --- PASS: TestNewHookExecutor_DefaultValues/zero_max_concurrent_uses_default (0.00s)
    --- PASS: TestNewHookExecutor_DefaultValues/negative_max_concurrent_uses_default (0.00s)
    --- PASS: TestNewHookExecutor_DefaultValues/zero_timeout_uses_default (0.00s)
    --- PASS: TestNewHookExecutor_DefaultValues/negative_timeout_uses_default (0.00s)
    --- PASS: TestNewHookExecutor_DefaultValues/both_zero_use_defaults (0.00s)
=== RUN   TestHookExecutor_Execute_ConcurrencyControl
--- PASS: TestHookExecutor_Execute_ConcurrencyControl (0.15s)
=== RUN   TestHookExecutor_Execute_ExecutionTimeout
--- PASS: TestHookExecutor_Execute_ExecutionTimeout (0.10s)
=== RUN   TestHookExecutor_Execute_AcquisitionTimeout
--- PASS: TestHookExecutor_Execute_AcquisitionTimeout (0.11s)
=== RUN   TestHookExecutor_Execute_ContextCancellation
--- PASS: TestHookExecutor_Execute_ContextCancellation (0.01s)
=== RUN   TestHookExecutor_Execute_Success
--- PASS: TestHookExecutor_Execute_Success (0.00s)
=== RUN   TestHookExecutor_Execute_WithResponseWriter
--- PASS: TestHookExecutor_Execute_WithResponseWriter (0.00s)
=== RUN   TestHookExecutor_Execute_MultipleConcurrent
--- PASS: TestHookExecutor_Execute_MultipleConcurrent (0.04s)
=== RUN   TestHookExecutor_GetMaxConcurrent
--- PASS: TestHookExecutor_GetMaxConcurrent (0.00s)
=== RUN   TestHookExecutor_GetDefaultTimeout
--- PASS: TestHookExecutor_GetDefaultTimeout (0.00s)
=== RUN   TestNewHookExecutorWithFunc
--- PASS: TestNewHookExecutorWithFunc (0.00s)
=== RUN   TestNewHookExecutor_Panic
--- PASS: TestNewHookExecutor_Panic (0.00s)
=== RUN   TestLaunch
--- PASS: TestLaunch (0.05s)
=== RUN   TestLaunch_WithDebug
--- PASS: TestLaunch_WithDebug (0.05s)
=== RUN   TestLaunch_RootHandler
--- PASS: TestLaunch_RootHandler (0.08s)
=== RUN   TestServer_Shutdown
--- PASS: TestServer_Shutdown (0.10s)
=== RUN   TestServer_Shutdown_Timeout
--- PASS: TestServer_Shutdown_Timeout (0.11s)
=== RUN   TestServer_IsShuttingDown
--- PASS: TestServer_IsShuttingDown (0.15s)
=== RUN   TestLaunch_WithRateLimit
--- PASS: TestLaunch_WithRateLimit (0.05s)
=== RUN   TestLaunch_HealthEndpoint
--- PASS: TestLaunch_HealthEndpoint (0.05s)
=== RUN   TestLaunch_MetricsEndpoint
--- PASS: TestLaunch_MetricsEndpoint (0.06s)
=== RUN   TestWriteHttpResponseCode
=== RUN   TestWriteHttpResponseCode/Valid_200
=== RUN   TestWriteHttpResponseCode/Valid_404
=== RUN   TestWriteHttpResponseCode/Valid_500
=== RUN   TestWriteHttpResponseCode/Invalid_code
--- PASS: TestWriteHttpResponseCode (0.00s)
    --- PASS: TestWriteHttpResponseCode/Valid_200 (0.00s)
    --- PASS: TestWriteHttpResponseCode/Valid_404 (0.00s)
    --- PASS: TestWriteHttpResponseCode/Valid_500 (0.00s)
    --- PASS: TestWriteHttpResponseCode/Invalid_code (0.00s)
=== RUN   TestFlushWriter
--- PASS: TestFlushWriter (0.00s)
=== RUN   TestMakeSureCallable
--- PASS: TestMakeSureCallable (0.00s)
=== RUN   TestMakeSureCallable_RelativePath
--- PASS: TestMakeSureCallable_RelativePath (0.00s)
=== RUN   TestMakeSureCallable_WithSpace
--- PASS: TestMakeSureCallable_WithSpace (0.00s)
=== RUN   TestCreateHookHandler_HookNotFound
--- PASS: TestCreateHookHandler_HookNotFound (0.00s)
=== RUN   TestCreateHookHandler_MethodNotAllowed
--- PASS: TestCreateHookHandler_MethodNotAllowed (0.00s)
=== RUN   TestCreateHookHandler_AppFlagsHttpMethods
--- PASS: TestCreateHookHandler_AppFlagsHttpMethods (0.00s)
=== RUN   TestHandleHook_StreamOutput
--- PASS: TestHandleHook_StreamOutput (1.23s)
=== RUN   TestHandleHook_CaptureOutput
--- PASS: TestHandleHook_CaptureOutput (1.36s)
=== RUN   TestHandleHook_Async
--- PASS: TestHandleHook_Async (0.60s)
=== RUN   TestFlushWriter_WithFlusher
--- PASS: TestFlushWriter_WithFlusher (0.00s)
=== RUN   TestCreateHookHandler_JSONContentType
--- PASS: TestCreateHookHandler_JSONContentType (0.00s)
=== RUN   TestCreateHookHandler_XMLContentType
--- PASS: TestCreateHookHandler_XMLContentType (0.00s)
=== RUN   TestCreateHookHandler_FormUrlEncodedContentType
--- PASS: TestCreateHookHandler_FormUrlEncodedContentType (0.00s)
=== RUN   TestCreateHookHandler_UnsupportedContentType
--- PASS: TestCreateHookHandler_UnsupportedContentType (0.00s)
=== RUN   TestCreateHookHandler_WithTriggerRule
--- PASS: TestCreateHookHandler_WithTriggerRule (0.00s)
=== RUN   TestCreateHookHandler_WithResponseHeaders
--- PASS: TestCreateHookHandler_WithResponseHeaders (0.00s)
=== RUN   TestMakeSureCallable_PermissionDenied
--- PASS: TestMakeSureCallable_PermissionDenied (0.00s)
=== RUN   TestMakeSureCallable_CommandNotFound
--- PASS: TestMakeSureCallable_CommandNotFound (0.00s)
=== RUN   TestMakeSureCallable_CommandWithSpace
--- PASS: TestMakeSureCallable_CommandWithSpace (0.00s)
=== RUN   TestHandleHook_FileCreationError
--- PASS: TestHandleHook_FileCreationError (0.64s)
=== RUN   TestHandleHook_CommandError
--- PASS: TestHandleHook_CommandError (1.03s)
=== RUN   TestCreateHookHandler_MultipartForm
--- PASS: TestCreateHookHandler_MultipartForm (0.00s)
=== RUN   TestCreateHookHandler_MultipartFormWithFile
--- PASS: TestCreateHookHandler_MultipartFormWithFile (0.00s)
=== RUN   TestCreateHookHandler_MultipartFormError
--- PASS: TestCreateHookHandler_MultipartFormError (0.00s)
=== RUN   TestCreateHookHandler_ReadBodyError
--- PASS: TestCreateHookHandler_ReadBodyError (0.00s)
=== RUN   TestCreateHookHandler_TriggerRuleError
--- PASS: TestCreateHookHandler_TriggerRuleError (0.00s)
=== RUN   TestCreateHookHandler_StreamCommandOutputError
--- PASS: TestCreateHookHandler_StreamCommandOutputError (0.89s)
=== RUN   TestCreateHookHandler_CaptureOutputOnError
--- PASS: TestCreateHookHandler_CaptureOutputOnError (0.72s)
=== RUN   TestCreateHookHandler_TriggerRuleMismatchHttpResponseCode
--- PASS: TestCreateHookHandler_TriggerRuleMismatchHttpResponseCode (0.00s)
=== RUN   TestCreateHookHandler_SuccessHttpResponseCode
--- PASS: TestCreateHookHandler_SuccessHttpResponseCode (0.00s)
=== RUN   TestHandleHook_FileOperations
--- PASS: TestHandleHook_FileOperations (0.75s)
=== RUN   TestMakeSureCallable_ChmodError
--- PASS: TestMakeSureCallable_ChmodError (0.00s)
=== RUN   TestTrackingResponseWriter
--- PASS: TestTrackingResponseWriter (0.00s)
=== RUN   TestTrackingResponseWriter_Flush
--- PASS: TestTrackingResponseWriter_Flush (0.00s)
=== RUN   TestGetAsyncHookWaitGroup
--- PASS: TestGetAsyncHookWaitGroup (0.00s)
=== RUN   TestStatusCodeResponseWriter
--- PASS: TestStatusCodeResponseWriter (0.00s)
=== RUN   TestSetResponseHeaders
--- PASS: TestSetResponseHeaders (0.00s)
=== RUN   TestIsMethodAllowed
=== RUN   TestIsMethodAllowed/hook_with_HTTPMethods
=== RUN   TestIsMethodAllowed/hook_with_HTTPMethods_not_matching
=== RUN   TestIsMethodAllowed/appFlags_with_HttpMethods
=== RUN   TestIsMethodAllowed/appFlags_with_HttpMethods_not_matching
=== RUN   TestIsMethodAllowed/default_allow_all
--- PASS: TestIsMethodAllowed (0.00s)
    --- PASS: TestIsMethodAllowed/hook_with_HTTPMethods (0.00s)
    --- PASS: TestIsMethodAllowed/hook_with_HTTPMethods_not_matching (0.00s)
    --- PASS: TestIsMethodAllowed/appFlags_with_HttpMethods (0.00s)
    --- PASS: TestIsMethodAllowed/appFlags_with_HttpMethods_not_matching (0.00s)
    --- PASS: TestIsMethodAllowed/default_allow_all (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/server	14.720s
=== RUN   TestInit
--- PASS: TestInit (0.00s)
=== RUN   TestIsEnabled
--- PASS: TestIsEnabled (0.00s)
=== RUN   TestStartSpan
--- PASS: TestStartSpan (0.00s)
=== RUN   TestInjectTraceContext
--- PASS: TestInjectTraceContext (0.00s)
=== RUN   TestExtractTraceContext
--- PASS: TestExtractTraceContext (0.00s)
=== RUN   TestWithTraceContext
--- PASS: TestWithTraceContext (0.00s)
=== RUN   TestTracingWithMiddleware
--- PASS: TestTracingWithMiddleware (0.00s)
=== RUN   TestTracingDisabled
--- PASS: TestTracingDisabled (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/tracing	4.318s
=== RUN   TestVersion
--- PASS: TestVersion (0.00s)
PASS
ok  	github.com/soulteary/webhook/internal/version	7.367s
?   	github.com/soulteary/webhook/test	[no test files]
FAIL
